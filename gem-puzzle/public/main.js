(()=>{"use strict";class t{constructor(){this.currentTime=0}calcCurrentTime(){this.time=setInterval((()=>{this.currentTime+=1,this.secToMinAndSec()}),1e3)}secToMinAndSec(){this.minutes=Math.floor(this.currentTime/60),this.sec=(this.currentTime%60).toFixed(0),this.timer=`${this.minutes}:${this.sec<10?"0":""}${this.sec}`,this.renderTimer()}timerStop(){clearInterval(this.time),this.timer="0:00",this.renderTimer()}timerPause(){clearInterval(this.time)}renderTimer(){document.querySelector(".time").innerHTML=this.timer}init(){this.timerStop(),this.currentTime=null,this.calcCurrentTime()}load(){this.timerStop(),this.secToMinAndSec(),this.renderTimer(),this.calcCurrentTime()}}const e=new class{constructor(){this.timerC=new t,this.history=[],this.size=4,this.emptyX=0,this.emptyY=0,this.animationTime=200,this.boardWidth=40.8,this.marginSize=.1,this.soundOn=!0,this.winSound=new Audio("../assets/win.mp3"),this.slideSound=new Audio("../assets/slide.mp3"),this.slideSound.volume=.2,this.removeBoard=()=>{document.querySelectorAll(".board").forEach((t=>{document.body.removeChild(t)}))}}randomImgNumber(t,e){this.imgNumb=Math.floor(Math.random()*(t-e)+e)}back(){this.history.pop(),this.backTimer()}backTimer(){setTimeout((()=>{if(this.history.length){const[t,e]=this.history.pop();this.e=document.querySelector("#cell-"+this.arr[t][e]),this.moveAnimation([t,e]),setTimeout((()=>{const i=this.arr[this.emptyX][this.emptyY];this.arr[this.emptyX][this.emptyY]=this.arr[t][e],this.arr[t][e]=i,this.emptyX=t,this.emptyY=e,this.removeBoard(),this.renderBoard(),this.playSlideSound(),this.backTimer()}),this.animationTime)}else this.checkWin()&&(this.setWinMessage(!0),this.playWinSound())}),this.animationTime)}move(t){switch(t){case"up":0!==this.emptyX&&(this.history.length<=2||this.emptyX-1!==this.history[this.history.length-2][0])?(this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX-1][this.emptyY],this.arr[this.emptyX-1][this.emptyY]=0,this.emptyX-=1,this.history.push([this.emptyX,this.emptyY])):this.counter-=1;break;case"down":this.emptyX!==this.size-1&&(this.history.length<=2||this.emptyX+1!==this.history[this.history.length-2][0])?(this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX+1][this.emptyY],this.arr[this.emptyX+1][this.emptyY]=0,this.emptyX+=1,this.history.push([this.emptyX,this.emptyY])):this.counter-=1;break;case"right":this.emptyY!==this.size-1&&(this.history.length<=2||this.emptyY+1!==this.history[this.history.length-2][1])?(this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX][this.emptyY+1],this.arr[this.emptyX][this.emptyY+1]=0,this.emptyY+=1,this.history.push([this.emptyX,this.emptyY])):this.counter-=1;break;case"left":0!==this.emptyY&&(this.history.length<=2||this.emptyY-1!==this.history[this.history.length-2][1])?(this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX][this.emptyY-1],this.arr[this.emptyX][this.emptyY-1]=0,this.emptyY-=1,this.history.push([this.emptyX,this.emptyY])):this.counter-=1;break;default:throw new Error(">:(")}}createBoard(){const t=[];this.bgPosArr=[];for(let e=0;e<this.size;e+=1){t[e]=[];for(let i=0;i<this.size;i+=1)e+i!==2*(this.size-1)?(t[e][i]=e*this.size+i+1,this.bgPosArr.push(`${Math.round(100/(this.size-1)*i)}% ${Math.round(100/(this.size-1)*e)}%`)):t[e][i]=0}return t}shuffle(){for(this.history.push([this.emptyX,this.emptyY]),this.counter=0;this.counter<this.size**3;this.counter+=1)switch(Math.floor(4*Math.random())){case 0:this.move("up");break;case 1:this.move("right");break;case 2:this.move("down");break;case 3:this.move("left");break;default:throw new Error(">:(")}}renderBoard(){let t="";const e=this.boardWidth+"rem";let i;for(let s=0,r=1;s<this.size;s+=1)for(let h=0;h<this.size;h+=1){i=this.arr[s][h];const n=this.arr[s][h]?"cell":"cell empty",o=this.arr[s][h]?`background: url(../assets/images/${this.imgNumb}.jpg);`:"",a=!!this.arr[s][h],m=this.bgPosArr[i-1];r+=1,t+=`<div \n          style='width:${this.cellSize}rem;\n          height:${this.cellSize}rem;\n          order:${r};\n          ${o}\n          background-position: ${m};\n          background-size: ${e};'\n          id='cell-${i}'\n          class='${n}'\n          draggable="${a}">${i}</div>`}const s=document.createElement("div");s.classList.add("board"),s.style.width=e,s.innerHTML=t,document.body.appendChild(s)}draw(){const t=this.cellSize/this.animationTime*this.timePassed;switch(this.direction){case"up":this.e.style.transform=`translate( 0, ${-t}rem)`;break;case"down":this.e.style.transform=`translate( 0, ${t}rem)`;break;case"left":this.e.style.transform=`translate( ${-t}rem, 0)`;break;case"right":this.e.style.transform=`translate( ${t}rem, 0)`;break;default:throw console.error(this.direction),new Error(">:(")}}moveAnimation([t,e]){console.log(t,e,"#",this.emptyX,this.emptyY,this.history[this.history.length-1]),this.emptyX<t?this.direction="up":this.emptyX>t?this.direction="down":this.emptyY<e?this.direction="left":this.emptyY>e&&(this.direction="right"),console.log(this.direction),this.inAnimation=!0,this.start=Date.now(),this.timer=setInterval((()=>{if(this.timePassed=Date.now()-this.start,this.timePassed>=this.animationTime)return clearInterval(this.timer),void(this.inAnimation=!1);this.draw()}),20)}toggleSound(){this.soundOn=!this.soundOn}swap(t){if(!this.inAnimation)for(let e=0;e<this.arr.length;e+=1)for(let i=0;i<this.arr[e].length;i+=1)if(this.arr[e][i]===t&&(Math.abs(this.emptyX-e)<=1&&this.emptyY-i==0||Math.abs(this.emptyY-i)<=1&&this.emptyX-e==0)){this.movesCounter+=1,document.querySelector(".move").innerHTML=this.movesCounter;const t=document.querySelector("#cell-"+this.arr[this.emptyX][this.emptyY]);return this.e=document.querySelector("#cell-"+this.arr[e][i]),this.moveAnimation([e,i]),this.playSlideSound(),setTimeout((()=>{const e=t.style.order;t.style.order=this.e.style.order,this.e.style.order=e,this.e.style.transform="",this.emptyX===this.emptyY&&this.emptyY===this.size-1&&this.checkWin()&&(this.timerC.timerPause(),this.setWinMessage(),this.playWinSound())}),this.animationTime),[this.arr[e][i],this.arr[this.emptyX][this.emptyY]]=[this.arr[this.emptyX][this.emptyY],this.arr[e][i]],this.emptyX=e,this.emptyY=i,void this.history.push([this.emptyX,this.emptyY])}}checkWin(){for(let t=0;t<this.size;t+=1)for(let e=0;e<this.size;e+=1)if(t+e!==2*(this.size-1)&&this.win[t][e]!==this.arr[t][e])return!1;return!0}setWinMessage(t){this.winBoard=document.querySelector(".board"),this.winBoard.classList.add("win"),t?this.winBoard.innerHTML+="<span class='win-text'>ЧИТЕР!</span>":this.winBoard.innerHTML=`<span class='win-text'>Ура! Вы решили головоломку за ${document.querySelector(".time").innerHTML} и ${document.querySelector(".move").innerHTML} ходов</span>`}playWinSound(){this.soundOn&&(this.winSound.currentTime=0,this.winSound.play())}playSlideSound(){this.soundOn&&(this.slideSound.currentTime=0,this.slideSound.play())}init(){this.randomImgNumber(150,1),this.history=[],this.movesCounter=0,document.querySelector(".move").innerHTML=this.movesCounter,this.size=document.getElementById("fieldSize").value,this.cellSize=parseFloat(this.boardWidth/this.size-2*this.marginSize).toFixed(3),this.removeBoard(),this.emptyX=this.size-1,this.emptyY=this.size-1,this.arr=this.createBoard(),this.win=this.createBoard(),this.shuffle(),this.renderBoard(),this.timerC.init(),document.querySelectorAll(".cell").forEach((t=>{t.addEventListener("mouseup",(t=>{const e=t.target;this.swap(parseInt(e.innerHTML,10))})),t.addEventListener("dragstart",this.dragStart),t.addEventListener("dragover",this.dragOver),t.addEventListener("drop",this.dragDrop),t.addEventListener("dragend",this.dragEnd)}))}load(){this.cellSize=parseFloat(this.boardWidth/this.size-2*this.marginSize).toFixed(3),document.querySelector(".move").innerHTML=this.movesCounter,this.removeBoard(),this.renderBoard(),this.win=this.createBoard(),this.timerC.init(),document.querySelectorAll(".cell").forEach((t=>{t.addEventListener("mouseup",(t=>{const e=t.target;this.swap(parseInt(e.innerHTML,10))})),t.addEventListener("dragstart",this.dragStart),t.addEventListener("dragover",this.dragOver),t.addEventListener("drop",this.dragDrop),t.addEventListener("dragend",this.dragEnd)}))}},i=document.createElement("header");i.classList.add("header"),i.innerHTML='<h1 class="heading">gem puzzle</h1>',document.body.appendChild(i);const s=document.createElement("div");s.classList.add("menu"),s.innerHTML='  \n  <div class="settings">\n    <button class="new-game btn">New</button>\n    <button class="save btn">Save</button>\n    <button class="load btn">Load</button>\n    <button class="sound btn">Sound</button>\n    <div class="size">\n      <select id="fieldSize">\n      <option selected="selected" value="4" disabled>Field size</option>\n        <option value="3">3</option>\n        <option value="4">4</option>\n        <option value="5">5</option>\n        <option value="6">6</option>\n        <option value="7">7</option>\n        <option value="8">8</option>\n      </select>\n    </div>\n    <button class="cheat btn">CHEAT</button>\n  </div>\n  <div class="counters">\n    <div class="timer"><span>Timer:</span><span class="time">0:00</span></div>\n    <div class="moves"><span>Moves:</span><span class="move">0</span></div>\n  </div>',document.body.appendChild(s),e.init(),document.querySelector(".new-game").addEventListener("click",(()=>{e.init()})),document.querySelector(".save").addEventListener("click",(()=>{localStorage.setItem("gameSave",JSON.stringify({bgPosition:e.bgPosArr,history:e.history,size:e.size,boardTable:e.arr,time:e.timerC.currentTime,moves:e.movesCounter,zero:[e.emptyX,e.emptyY],imgNumb:e.imgNumb}))})),document.querySelector(".load").addEventListener("click",(()=>{const{bgPosition:t,history:i,size:s,boardTable:r,time:h,moves:n,zero:o,imgNumb:a}=JSON.parse(localStorage.getItem("gameSave"));e.bgPosArr=t,e.history=i,e.size=s,e.timerC.currentTime=h,e.movesCounter=n,e.arr=r,[e.emptyX,e.emptyY]=o,e.imgNumb=a,e.load(),e.timerC.load()})),document.getElementById("fieldSize").addEventListener("change",(()=>{e.init(),e.timerC.init()})),document.querySelector(".cheat").addEventListener("click",(()=>{e.timerC.timerPause(),e.back()})),document.querySelector(".sound").addEventListener("click",(()=>{e.toggleSound()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW0tcHV6emxlLy4vc3JjL1RpbWVyLmpzIiwid2VicGFjazovL2dlbS1wdXp6bGUvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZ2VtLXB1enpsZS8uL3NyYy9Cb2FyZC5qcyJdLCJuYW1lcyI6WyJUaW1lciIsInRoaXMiLCJjdXJyZW50VGltZSIsInRpbWUiLCJzZXRJbnRlcnZhbCIsInNlY1RvTWluQW5kU2VjIiwibWludXRlcyIsIk1hdGgiLCJmbG9vciIsInNlYyIsInRvRml4ZWQiLCJ0aW1lciIsInJlbmRlclRpbWVyIiwiY2xlYXJJbnRlcnZhbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInRpbWVyU3RvcCIsImNhbGNDdXJyZW50VGltZSIsImJvYXJkIiwidGltZXJDIiwiaGlzdG9yeSIsInNpemUiLCJlbXB0eVgiLCJlbXB0eVkiLCJhbmltYXRpb25UaW1lIiwiYm9hcmRXaWR0aCIsIm1hcmdpblNpemUiLCJzb3VuZE9uIiwid2luU291bmQiLCJBdWRpbyIsInNsaWRlU291bmQiLCJ2b2x1bWUiLCJyZW1vdmVCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWxlbSIsImJvZHkiLCJyZW1vdmVDaGlsZCIsIm1heCIsIm1pbiIsImltZ051bWIiLCJyYW5kb20iLCJwb3AiLCJiYWNrVGltZXIiLCJzZXRUaW1lb3V0IiwibGVuZ3RoIiwieCIsInkiLCJlIiwiYXJyIiwibW92ZUFuaW1hdGlvbiIsInRlbXAiLCJyZW5kZXJCb2FyZCIsInBsYXlTbGlkZVNvdW5kIiwiY2hlY2tXaW4iLCJzZXRXaW5NZXNzYWdlIiwicGxheVdpblNvdW5kIiwiZGlyZWN0aW9uIiwicHVzaCIsImNvdW50ZXIiLCJFcnJvciIsImJnUG9zQXJyIiwiaSIsImoiLCJyb3VuZCIsIm1vdmUiLCJjZWxsTnVtYmVyIiwib3JkZXIiLCJjbGFzc05hbWUiLCJiZ0ZvckNlbGwiLCJkcmFnZ2FibGUiLCJiR3BvcyIsImNlbGxTaXplIiwiZWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzdHlsZSIsIndpZHRoIiwiYXBwZW5kQ2hpbGQiLCJyZW1QZXJUaWNrIiwidGltZVBhc3NlZCIsInRyYW5zZm9ybSIsImNvbnNvbGUiLCJlcnJvciIsImxvZyIsImluQW5pbWF0aW9uIiwic3RhcnQiLCJEYXRlIiwibm93IiwiZHJhdyIsIm51bWJlciIsImFicyIsIm1vdmVzQ291bnRlciIsInplcm8iLCJ0aW1lclBhdXNlIiwid2luIiwiY2hlYXQiLCJ3aW5Cb2FyZCIsInBsYXkiLCJyYW5kb21JbWdOdW1iZXIiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwicGFyc2VGbG9hdCIsImNyZWF0ZUJvYXJkIiwic2h1ZmZsZSIsImluaXQiLCJjZWxsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInRhcmdldCIsInN3YXAiLCJwYXJzZUludCIsImRyYWdTdGFydCIsImRyYWdPdmVyIiwiZHJhZ0Ryb3AiLCJkcmFnRW5kIiwiaGVhZGVyIiwibWVudSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiYmdQb3NpdGlvbiIsImJvYXJkVGFibGUiLCJtb3ZlcyIsInBhcnNlIiwiZ2V0SXRlbSIsImxvYWQiLCJiYWNrIiwidG9nZ2xlU291bmQiXSwibWFwcGluZ3MiOiJtQkFBZSxNQUFNQSxFQUNuQixjQUNFQyxLQUFLQyxZQUFjLEVBSXJCLGtCQUNFRCxLQUFLRSxLQUFPQyxhQUFZLEtBQ3RCSCxLQUFLQyxhQUFlLEVBQ3BCRCxLQUFLSSxtQkFDSixLQUdMLGlCQUNFSixLQUFLSyxRQUFVQyxLQUFLQyxNQUFNUCxLQUFLQyxZQUFjLElBRTdDRCxLQUFLUSxLQUFPUixLQUFLQyxZQUFjLElBQUlRLFFBQVEsR0FDM0NULEtBQUtVLE1BQVEsR0FBR1YsS0FBS0ssV0FBV0wsS0FBS1EsSUFBTSxHQUFLLElBQU0sS0FBS1IsS0FBS1EsTUFDaEVSLEtBQUtXLGNBR1AsWUFDRUMsY0FB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LCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVyIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgLy8gdGhpcy50aW1lciA9ICcwOjAwJztcclxuICB9XHJcblxyXG4gIGNhbGNDdXJyZW50VGltZSgpIHtcclxuICAgIHRoaXMudGltZSA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgdGhpcy5jdXJyZW50VGltZSArPSAxO1xyXG4gICAgICB0aGlzLnNlY1RvTWluQW5kU2VjKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcblxyXG4gIHNlY1RvTWluQW5kU2VjKCkge1xyXG4gICAgdGhpcy5taW51dGVzID0gTWF0aC5mbG9vcih0aGlzLmN1cnJlbnRUaW1lIC8gNjApO1xyXG5cclxuICAgIHRoaXMuc2VjID0gKHRoaXMuY3VycmVudFRpbWUgJSA2MCkudG9GaXhlZCgwKTtcclxuICAgIHRoaXMudGltZXIgPSBgJHt0aGlzLm1pbnV0ZXN9OiR7dGhpcy5zZWMgPCAxMCA/ICcwJyA6ICcnfSR7dGhpcy5zZWN9YDtcclxuICAgIHRoaXMucmVuZGVyVGltZXIoKTtcclxuICB9XHJcblxyXG4gIHRpbWVyU3RvcCgpIHtcclxuICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lKTtcclxuICAgIHRoaXMudGltZXIgPSAnMDowMCc7XHJcbiAgICB0aGlzLnJlbmRlclRpbWVyKCk7XHJcbiAgfVxyXG5cclxuICB0aW1lclBhdXNlKCkge1xyXG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWUpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyVGltZXIoKSB7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGltZScpLmlubmVySFRNTCA9IHRoaXMudGltZXI7XHJcbiAgfVxyXG5cclxuICBpbml0KCkge1xyXG4gICAgdGhpcy50aW1lclN0b3AoKTtcclxuICAgIHRoaXMuY3VycmVudFRpbWUgPSBudWxsO1xyXG4gICAgdGhpcy5jYWxjQ3VycmVudFRpbWUoKTtcclxuICB9XHJcblxyXG4gIGxvYWQoKSB7XHJcbiAgICB0aGlzLnRpbWVyU3RvcCgpO1xyXG4gICAgdGhpcy5zZWNUb01pbkFuZFNlYygpO1xyXG4gICAgdGhpcy5yZW5kZXJUaW1lcigpO1xyXG5cclxuICAgIHRoaXMuY2FsY0N1cnJlbnRUaW1lKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBCb2FyZCBmcm9tICcuL0JvYXJkLmpzJztcclxuXHJcbmNvbnN0IGJvYXJkID0gbmV3IEJvYXJkKCk7XHJcblxyXG5jb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoZWFkZXInKTtcclxuaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2hlYWRlcicpO1xyXG5oZWFkZXIuaW5uZXJIVE1MID0gJzxoMSBjbGFzcz1cImhlYWRpbmdcIj5nZW0gcHV6emxlPC9oMT4nO1xyXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGhlYWRlcik7XHJcblxyXG5jb25zdCBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbm1lbnUuY2xhc3NMaXN0LmFkZCgnbWVudScpO1xyXG5cclxubWVudS5pbm5lckhUTUwgPSBgICBcclxuICA8ZGl2IGNsYXNzPVwic2V0dGluZ3NcIj5cclxuICAgIDxidXR0b24gY2xhc3M9XCJuZXctZ2FtZSBidG5cIj5OZXc8L2J1dHRvbj5cclxuICAgIDxidXR0b24gY2xhc3M9XCJzYXZlIGJ0blwiPlNhdmU8L2J1dHRvbj5cclxuICAgIDxidXR0b24gY2xhc3M9XCJsb2FkIGJ0blwiPkxvYWQ8L2J1dHRvbj5cclxuICAgIDxidXR0b24gY2xhc3M9XCJzb3VuZCBidG5cIj5Tb3VuZDwvYnV0dG9uPlxyXG4gICAgPGRpdiBjbGFzcz1cInNpemVcIj5cclxuICAgICAgPHNlbGVjdCBpZD1cImZpZWxkU2l6ZVwiPlxyXG4gICAgICA8b3B0aW9uIHNlbGVjdGVkPVwic2VsZWN0ZWRcIiB2YWx1ZT1cIjRcIiBkaXNhYmxlZD5GaWVsZCBzaXplPC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjNcIj4zPC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjRcIj40PC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjVcIj41PC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjZcIj42PC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjdcIj43PC9vcHRpb24+XHJcbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjhcIj44PC9vcHRpb24+XHJcbiAgICAgIDwvc2VsZWN0PlxyXG4gICAgPC9kaXY+XHJcbiAgICA8YnV0dG9uIGNsYXNzPVwiY2hlYXQgYnRuXCI+Q0hFQVQ8L2J1dHRvbj5cclxuICA8L2Rpdj5cclxuICA8ZGl2IGNsYXNzPVwiY291bnRlcnNcIj5cclxuICAgIDxkaXYgY2xhc3M9XCJ0aW1lclwiPjxzcGFuPlRpbWVyOjwvc3Bhbj48c3BhbiBjbGFzcz1cInRpbWVcIj4wOjAwPC9zcGFuPjwvZGl2PlxyXG4gICAgPGRpdiBjbGFzcz1cIm1vdmVzXCI+PHNwYW4+TW92ZXM6PC9zcGFuPjxzcGFuIGNsYXNzPVwibW92ZVwiPjA8L3NwYW4+PC9kaXY+XHJcbiAgPC9kaXY+YDtcclxuXHJcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWVudSk7XHJcblxyXG5ib2FyZC5pbml0KCk7XHJcblxyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LWdhbWUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBib2FyZC5pbml0KCk7XHJcbn0pO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNhdmUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcclxuICAgICdnYW1lU2F2ZScsXHJcbiAgICBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIGJnUG9zaXRpb246IGJvYXJkLmJnUG9zQXJyLFxyXG4gICAgICBoaXN0b3J5OiBib2FyZC5oaXN0b3J5LFxyXG4gICAgICBzaXplOiBib2FyZC5zaXplLFxyXG4gICAgICBib2FyZFRhYmxlOiBib2FyZC5hcnIsXHJcbiAgICAgIHRpbWU6IGJvYXJkLnRpbWVyQy5jdXJyZW50VGltZSxcclxuICAgICAgbW92ZXM6IGJvYXJkLm1vdmVzQ291bnRlcixcclxuICAgICAgemVybzogWyBib2FyZC5lbXB0eVgsIGJvYXJkLmVtcHR5WSBdLFxyXG4gICAgICBpbWdOdW1iOiBib2FyZC5pbWdOdW1iXHJcbiAgICB9KVxyXG4gICk7XHJcbn0pO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBjb25zdCB7IGJnUG9zaXRpb24sIGhpc3RvcnksIHNpemUsIGJvYXJkVGFibGUsIHRpbWUsIG1vdmVzLCB6ZXJvLCBpbWdOdW1iIH0gPSBKU09OLnBhcnNlKFxyXG4gICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2dhbWVTYXZlJylcclxuICApO1xyXG4gIGJvYXJkLmJnUG9zQXJyID0gYmdQb3NpdGlvbjtcclxuICBib2FyZC5oaXN0b3J5ID0gaGlzdG9yeTtcclxuICBib2FyZC5zaXplID0gc2l6ZTtcclxuICBib2FyZC50aW1lckMuY3VycmVudFRpbWUgPSB0aW1lO1xyXG4gIGJvYXJkLm1vdmVzQ291bnRlciA9IG1vdmVzO1xyXG4gIGJvYXJkLmFyciA9IGJvYXJkVGFibGU7XHJcbiAgWyBib2FyZC5lbXB0eVgsIGJvYXJkLmVtcHR5WSBdID0gemVybztcclxuICBib2FyZC5pbWdOdW1iID0gaW1nTnVtYjtcclxuICBib2FyZC5sb2FkKCk7XHJcbiAgYm9hcmQudGltZXJDLmxvYWQoKTtcclxufSk7XHJcblxyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmllbGRTaXplJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xyXG4gIGJvYXJkLmluaXQoKTtcclxuICBib2FyZC50aW1lckMuaW5pdCgpO1xyXG59KTtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGVhdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGJvYXJkLnRpbWVyQy50aW1lclBhdXNlKCk7XHJcbiAgYm9hcmQuYmFjaygpO1xyXG59KTtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zb3VuZCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGJvYXJkLnRvZ2dsZVNvdW5kKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgVGltZXIgZnJvbSAnLi9UaW1lci5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb2FyZCB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnRpbWVyQyA9IG5ldyBUaW1lcigpO1xyXG4gICAgdGhpcy5oaXN0b3J5ID0gW107XHJcbiAgICB0aGlzLnNpemUgPSA0O1xyXG4gICAgdGhpcy5lbXB0eVggPSAwO1xyXG4gICAgdGhpcy5lbXB0eVkgPSAwO1xyXG4gICAgdGhpcy5hbmltYXRpb25UaW1lID0gMjAwO1xyXG5cclxuICAgIHRoaXMuYm9hcmRXaWR0aCA9IDQwLjg7XHJcbiAgICB0aGlzLm1hcmdpblNpemUgPSAwLjE7XHJcbiAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xyXG4gICAgdGhpcy53aW5Tb3VuZCA9IG5ldyBBdWRpbygnLi4vYXNzZXRzL3dpbi5tcDMnKTtcclxuICAgIHRoaXMuc2xpZGVTb3VuZCA9IG5ldyBBdWRpbygnLi4vYXNzZXRzL3NsaWRlLm1wMycpO1xyXG4gICAgdGhpcy5zbGlkZVNvdW5kLnZvbHVtZSA9IDAuMjtcclxuICAgIHRoaXMucmVtb3ZlQm9hcmQgPSAoKSA9PiB7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib2FyZCcpLmZvckVhY2goKGVsZW0pID0+IHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW0pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByYW5kb21JbWdOdW1iZXIobWF4LCBtaW4pIHtcclxuICAgIHRoaXMuaW1nTnVtYiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluKTtcclxuICB9XHJcblxyXG4gIGJhY2soKSB7XHJcbiAgICB0aGlzLmhpc3RvcnkucG9wKCk7XHJcbiAgICB0aGlzLmJhY2tUaW1lcigpO1xyXG4gIH1cclxuXHJcbiAgYmFja1RpbWVyKCkge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmhpc3RvcnkubGVuZ3RoKSB7XHJcbiAgICAgICAgY29uc3QgWyB4LCB5IF0gPSB0aGlzLmhpc3RvcnkucG9wKCk7XHJcbiAgICAgICAgdGhpcy5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NlbGwtJHt0aGlzLmFyclt4XVt5XX1gKTtcclxuXHJcbiAgICAgICAgdGhpcy5tb3ZlQW5pbWF0aW9uKFsgeCwgeSBdKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB0ZW1wID0gdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZXTtcclxuICAgICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WV0gPSB0aGlzLmFyclt4XVt5XTtcclxuICAgICAgICAgIHRoaXMuYXJyW3hdW3ldID0gdGVtcDtcclxuICAgICAgICAgIHRoaXMuZW1wdHlYID0geDtcclxuICAgICAgICAgIHRoaXMuZW1wdHlZID0geTtcclxuICAgICAgICAgIHRoaXMucmVtb3ZlQm9hcmQoKTtcclxuICAgICAgICAgIHRoaXMucmVuZGVyQm9hcmQoKTtcclxuICAgICAgICAgIHRoaXMucGxheVNsaWRlU291bmQoKTtcclxuICAgICAgICAgIHRoaXMuYmFja1RpbWVyKCk7XHJcbiAgICAgICAgfSwgdGhpcy5hbmltYXRpb25UaW1lKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrV2luKCkpIHtcclxuICAgICAgICB0aGlzLnNldFdpbk1lc3NhZ2UodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5wbGF5V2luU291bmQoKTtcclxuICAgICAgfVxyXG4gICAgfSwgdGhpcy5hbmltYXRpb25UaW1lKTtcclxuICB9XHJcblxyXG4gIG1vdmUoZGlyZWN0aW9uKSB7XHJcbiAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xyXG4gICAgICBjYXNlICd1cCc6XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgdGhpcy5lbXB0eVggIT09IDAgJiZcclxuICAgICAgICAgICh0aGlzLmhpc3RvcnkubGVuZ3RoIDw9IDIgfHwgdGhpcy5lbXB0eVggLSAxICE9PSB0aGlzLmhpc3RvcnlbdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDJdWzBdKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZXSA9IHRoaXMuYXJyW3RoaXMuZW1wdHlYIC0gMV1bdGhpcy5lbXB0eVldO1xyXG4gICAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVggLSAxXVt0aGlzLmVtcHR5WV0gPSAwO1xyXG4gICAgICAgICAgdGhpcy5lbXB0eVggLT0gMTtcclxuICAgICAgICAgIHRoaXMuaGlzdG9yeS5wdXNoKFsgdGhpcy5lbXB0eVgsIHRoaXMuZW1wdHlZIF0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmNvdW50ZXIgLT0gMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdkb3duJzpcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICB0aGlzLmVtcHR5WCAhPT0gdGhpcy5zaXplIC0gMSAmJlxyXG4gICAgICAgICAgKHRoaXMuaGlzdG9yeS5sZW5ndGggPD0gMiB8fCB0aGlzLmVtcHR5WCArIDEgIT09IHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMl1bMF0pXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldID0gdGhpcy5hcnJbdGhpcy5lbXB0eVggKyAxXVt0aGlzLmVtcHR5WV07XHJcbiAgICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WCArIDFdW3RoaXMuZW1wdHlZXSA9IDA7XHJcbiAgICAgICAgICB0aGlzLmVtcHR5WCArPSAxO1xyXG4gICAgICAgICAgdGhpcy5oaXN0b3J5LnB1c2goWyB0aGlzLmVtcHR5WCwgdGhpcy5lbXB0eVkgXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuY291bnRlciAtPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIHRoaXMuZW1wdHlZICE9PSB0aGlzLnNpemUgLSAxICYmXHJcbiAgICAgICAgICAodGhpcy5oaXN0b3J5Lmxlbmd0aCA8PSAyIHx8IHRoaXMuZW1wdHlZICsgMSAhPT0gdGhpcy5oaXN0b3J5W3RoaXMuaGlzdG9yeS5sZW5ndGggLSAyXVsxXSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WV0gPSB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVkgKyAxXTtcclxuICAgICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WSArIDFdID0gMDtcclxuICAgICAgICAgIHRoaXMuZW1wdHlZICs9IDE7XHJcbiAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaChbIHRoaXMuZW1wdHlYLCB0aGlzLmVtcHR5WSBdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5jb3VudGVyIC09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICB0aGlzLmVtcHR5WSAhPT0gMCAmJlxyXG4gICAgICAgICAgKHRoaXMuaGlzdG9yeS5sZW5ndGggPD0gMiB8fCB0aGlzLmVtcHR5WSAtIDEgIT09IHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMl1bMV0pXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldID0gdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZIC0gMV07XHJcbiAgICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVkgLSAxXSA9IDA7XHJcbiAgICAgICAgICB0aGlzLmVtcHR5WSAtPSAxO1xyXG4gICAgICAgICAgdGhpcy5oaXN0b3J5LnB1c2goWyB0aGlzLmVtcHR5WCwgdGhpcy5lbXB0eVkgXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuY291bnRlciAtPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJz46KCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlQm9hcmQoKSB7XHJcbiAgICBjb25zdCBhcnIgPSBbXTtcclxuXHJcbiAgICB0aGlzLmJnUG9zQXJyID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2l6ZTsgaSArPSAxKSB7XHJcbiAgICAgIGFycltpXSA9IFtdO1xyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgaWYgKGkgKyBqICE9PSAodGhpcy5zaXplIC0gMSkgKiAyKSB7XHJcbiAgICAgICAgICBhcnJbaV1bal0gPSBpICogdGhpcy5zaXplICsgaiArIDE7XHJcbiAgICAgICAgICB0aGlzLmJnUG9zQXJyLnB1c2goXHJcbiAgICAgICAgICAgIGAke01hdGgucm91bmQoMTAwIC8gKHRoaXMuc2l6ZSAtIDEpICogail9JSAke01hdGgucm91bmQoMTAwIC8gKHRoaXMuc2l6ZSAtIDEpICogaSl9JWBcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFycltpXVtqXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH1cclxuXHJcbiAgc2h1ZmZsZSgpIHtcclxuICAgIHRoaXMuaGlzdG9yeS5wdXNoKFsgdGhpcy5lbXB0eVgsIHRoaXMuZW1wdHlZIF0pO1xyXG4gICAgZm9yICh0aGlzLmNvdW50ZXIgPSAwOyB0aGlzLmNvdW50ZXIgPCB0aGlzLnNpemUgKiogMzsgdGhpcy5jb3VudGVyICs9IDEpIHtcclxuICAgICAgc3dpdGNoIChNYXRoLmZsb29yKDQgKiBNYXRoLnJhbmRvbSgpKSkge1xyXG4gICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgIC8vICBNT1ZFIFVQXHJcblxyXG4gICAgICAgICAgdGhpcy5tb3ZlKCd1cCcpO1xyXG5cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgIC8vICBNT1ZFIFJJR0hUXHJcbiAgICAgICAgICB0aGlzLm1vdmUoJ3JpZ2h0Jyk7XHJcblxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgLy8gIE1PVkUgRE9XTlxyXG4gICAgICAgICAgdGhpcy5tb3ZlKCdkb3duJyk7XHJcblxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgLy8gIE1PVkUgTEVGVFxyXG4gICAgICAgICAgdGhpcy5tb3ZlKCdsZWZ0Jyk7XHJcblxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignPjooJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlckJvYXJkKCkge1xyXG4gICAgbGV0IGJvYXJkID0gJyc7XHJcbiAgICBjb25zdCBib2FyZFdpZHRoID0gYCR7dGhpcy5ib2FyZFdpZHRofXJlbWA7XHJcbiAgICBsZXQgY2VsbE51bWJlcjtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMCwgb3JkZXIgPSAxOyBpIDwgdGhpcy5zaXplOyBpICs9IDEpIHtcclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnNpemU7IGogKz0gMSkge1xyXG4gICAgICAgIGNlbGxOdW1iZXIgPSB0aGlzLmFycltpXVtqXTtcclxuXHJcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gdGhpcy5hcnJbaV1bal0gPyAnY2VsbCcgOiAnY2VsbCBlbXB0eSc7XHJcbiAgICAgICAgY29uc3QgYmdGb3JDZWxsID0gdGhpcy5hcnJbaV1bal1cclxuICAgICAgICAgID8gYGJhY2tncm91bmQ6IHVybCguLi9hc3NldHMvaW1hZ2VzLyR7dGhpcy5pbWdOdW1ifS5qcGcpO2BcclxuICAgICAgICAgIDogJyc7XHJcblxyXG4gICAgICAgIGNvbnN0IGRyYWdnYWJsZSA9ICEhdGhpcy5hcnJbaV1bal07XHJcbiAgICAgICAgY29uc3QgYkdwb3MgPSB0aGlzLmJnUG9zQXJyW2NlbGxOdW1iZXIgLSAxXTtcclxuICAgICAgICBvcmRlciArPSAxO1xyXG5cclxuICAgICAgICBib2FyZCArPSBgPGRpdiBcclxuICAgICAgICAgIHN0eWxlPSd3aWR0aDoke3RoaXMuY2VsbFNpemV9cmVtO1xyXG4gICAgICAgICAgaGVpZ2h0OiR7dGhpcy5jZWxsU2l6ZX1yZW07XHJcbiAgICAgICAgICBvcmRlcjoke29yZGVyfTtcclxuICAgICAgICAgICR7YmdGb3JDZWxsfVxyXG4gICAgICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogJHtiR3Bvc307XHJcbiAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6ICR7Ym9hcmRXaWR0aH07J1xyXG4gICAgICAgICAgaWQ9J2NlbGwtJHtjZWxsTnVtYmVyfSdcclxuICAgICAgICAgIGNsYXNzPScke2NsYXNzTmFtZX0nXHJcbiAgICAgICAgICBkcmFnZ2FibGU9XCIke2RyYWdnYWJsZX1cIj4ke2NlbGxOdW1iZXJ9PC9kaXY+YDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYm9hcmQnKTtcclxuICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBib2FyZFdpZHRoO1xyXG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSBib2FyZDtcclxuXHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgZHJhdygpIHtcclxuICAgIGNvbnN0IHJlbVBlclRpY2sgPSB0aGlzLmNlbGxTaXplIC8gdGhpcy5hbmltYXRpb25UaW1lICogdGhpcy50aW1lUGFzc2VkO1xyXG4gICAgc3dpdGNoICh0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICBjYXNlICd1cCc6XHJcbiAgICAgICAgdGhpcy5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoIDAsICR7LXJlbVBlclRpY2t9cmVtKWA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2Rvd24nOlxyXG4gICAgICAgIHRoaXMuZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCAwLCAke3JlbVBlclRpY2t9cmVtKWA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgIHRoaXMuZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCAkey1yZW1QZXJUaWNrfXJlbSwgMClgO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgdGhpcy5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoICR7cmVtUGVyVGlja31yZW0sIDApYDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMuZGlyZWN0aW9uKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJz46KCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbW92ZUFuaW1hdGlvbihbIHgsIHkgXSkge1xyXG4gICAgY29uc29sZS5sb2coeCwgeSwgJyMnLCB0aGlzLmVtcHR5WCwgdGhpcy5lbXB0eVksIHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMV0pO1xyXG4gICAgaWYgKHRoaXMuZW1wdHlYIDwgeCkge1xyXG4gICAgICB0aGlzLmRpcmVjdGlvbiA9ICd1cCc7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuZW1wdHlYID4geCkge1xyXG4gICAgICB0aGlzLmRpcmVjdGlvbiA9ICdkb3duJztcclxuICAgIH0gZWxzZSBpZiAodGhpcy5lbXB0eVkgPCB5KSB7XHJcbiAgICAgIHRoaXMuZGlyZWN0aW9uID0gJ2xlZnQnO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmVtcHR5WSA+IHkpIHtcclxuICAgICAgdGhpcy5kaXJlY3Rpb24gPSAncmlnaHQnO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2codGhpcy5kaXJlY3Rpb24pO1xyXG5cclxuICAgIHRoaXMuaW5BbmltYXRpb24gPSB0cnVlO1xyXG4gICAgdGhpcy5zdGFydCA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgdGhpcy50aW1lUGFzc2VkID0gRGF0ZS5ub3coKSAtIHRoaXMuc3RhcnQ7XHJcblxyXG4gICAgICBpZiAodGhpcy50aW1lUGFzc2VkID49IHRoaXMuYW5pbWF0aW9uVGltZSkge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XHJcbiAgICAgICAgdGhpcy5pbkFuaW1hdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICB9LCAyMCk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVTb3VuZCgpIHtcclxuICAgIHRoaXMuc291bmRPbiA9ICF0aGlzLnNvdW5kT247XHJcbiAgfVxyXG5cclxuICBzd2FwKG51bWJlcikge1xyXG4gICAgaWYgKHRoaXMuaW5BbmltYXRpb24pIHJldHVybjtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYXJyLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5hcnJbaV0ubGVuZ3RoOyBqICs9IDEpIHtcclxuICAgICAgICBpZiAodGhpcy5hcnJbaV1bal0gPT09IG51bWJlcikge1xyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAoTWF0aC5hYnModGhpcy5lbXB0eVggLSBpKSA8PSAxICYmIHRoaXMuZW1wdHlZIC0gaiA9PT0gMCkgfHxcclxuICAgICAgICAgICAgKE1hdGguYWJzKHRoaXMuZW1wdHlZIC0gaikgPD0gMSAmJiB0aGlzLmVtcHR5WCAtIGkgPT09IDApXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgLy8gTW92ZSBjb3VudGVyXHJcbiAgICAgICAgICAgIHRoaXMubW92ZXNDb3VudGVyICs9IDE7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb3ZlJykuaW5uZXJIVE1MID0gdGhpcy5tb3Zlc0NvdW50ZXI7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB6ZXJvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NlbGwtJHt0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldfWApO1xyXG4gICAgICAgICAgICB0aGlzLmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjY2VsbC0ke3RoaXMuYXJyW2ldW2pdfWApO1xyXG5cclxuICAgICAgICAgICAgLy8gIGZpbmQgd2hlcmUgYXJlIHdlIG1vdmluZ1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVBbmltYXRpb24oWyBpLCBqIF0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wbGF5U2xpZGVTb3VuZCgpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgdGVtcCA9IHplcm8uc3R5bGUub3JkZXI7XHJcbiAgICAgICAgICAgICAgemVyby5zdHlsZS5vcmRlciA9IHRoaXMuZS5zdHlsZS5vcmRlcjtcclxuICAgICAgICAgICAgICB0aGlzLmUuc3R5bGUub3JkZXIgPSB0ZW1wO1xyXG5cclxuICAgICAgICAgICAgICB0aGlzLmUuc3R5bGUudHJhbnNmb3JtID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgIGlmICh0aGlzLmVtcHR5WCA9PT0gdGhpcy5lbXB0eVkgJiYgdGhpcy5lbXB0eVkgPT09IHRoaXMuc2l6ZSAtIDEpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrV2luKCkpIHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy50aW1lckMudGltZXJQYXVzZSgpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnNldFdpbk1lc3NhZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5V2luU291bmQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuYW5pbWF0aW9uVGltZSk7XHJcbiAgICAgICAgICAgIFsgdGhpcy5hcnJbaV1bal0sIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WV0gXSA9IFtcclxuICAgICAgICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldLFxyXG4gICAgICAgICAgICAgIHRoaXMuYXJyW2ldW2pdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIHRoaXMuZW1wdHlYID0gaTtcclxuICAgICAgICAgICAgdGhpcy5lbXB0eVkgPSBqO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5oaXN0b3J5LnB1c2goWyB0aGlzLmVtcHR5WCwgdGhpcy5lbXB0eVkgXSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNoZWNrV2luKCkge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNpemU7IGkgKz0gMSkge1xyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgaWYgKGkgKyBqICE9PSAodGhpcy5zaXplIC0gMSkgKiAyKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy53aW5baV1bal0gIT09IHRoaXMuYXJyW2ldW2pdKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBzZXRXaW5NZXNzYWdlKGNoZWF0KSB7XHJcbiAgICB0aGlzLndpbkJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvYXJkJyk7XHJcbiAgICB0aGlzLndpbkJvYXJkLmNsYXNzTGlzdC5hZGQoJ3dpbicpO1xyXG5cclxuICAgIGlmIChjaGVhdCkge1xyXG4gICAgICB0aGlzLndpbkJvYXJkLmlubmVySFRNTCArPSBgPHNwYW4gY2xhc3M9J3dpbi10ZXh0Jz7Qp9CY0KLQldCgITwvc3Bhbj5gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy53aW5Cb2FyZC5pbm5lckhUTUwgPSBgPHNwYW4gY2xhc3M9J3dpbi10ZXh0Jz7Qo9GA0LAhINCS0Ysg0YDQtdGI0LjQu9C4INCz0L7Qu9C+0LLQvtC70L7QvNC60YMg0LfQsCAke2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgJy50aW1lJ1xyXG4gICAgICApLmlubmVySFRNTH0g0LggJHtkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW92ZScpLmlubmVySFRNTH0g0YXQvtC00L7Qsjwvc3Bhbj5gO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcGxheVdpblNvdW5kKCkge1xyXG4gICAgaWYgKCF0aGlzLnNvdW5kT24pIHJldHVybjtcclxuICAgIHRoaXMud2luU291bmQuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgdGhpcy53aW5Tb3VuZC5wbGF5KCk7XHJcbiAgfVxyXG5cclxuICBwbGF5U2xpZGVTb3VuZCgpIHtcclxuICAgIGlmICghdGhpcy5zb3VuZE9uKSByZXR1cm47XHJcbiAgICB0aGlzLnNsaWRlU291bmQuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgdGhpcy5zbGlkZVNvdW5kLnBsYXkoKTtcclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICB0aGlzLnJhbmRvbUltZ051bWJlcigxNTAsIDEpO1xyXG4gICAgdGhpcy5oaXN0b3J5ID0gW107XHJcbiAgICB0aGlzLm1vdmVzQ291bnRlciA9IDA7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW92ZScpLmlubmVySFRNTCA9IHRoaXMubW92ZXNDb3VudGVyO1xyXG4gICAgdGhpcy5zaXplID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpZWxkU2l6ZScpLnZhbHVlO1xyXG5cclxuICAgIHRoaXMuY2VsbFNpemUgPSBwYXJzZUZsb2F0KHRoaXMuYm9hcmRXaWR0aCAvIHRoaXMuc2l6ZSAtIDIgKiB0aGlzLm1hcmdpblNpemUpLnRvRml4ZWQoMyk7XHJcblxyXG4gICAgdGhpcy5yZW1vdmVCb2FyZCgpO1xyXG5cclxuICAgIHRoaXMuZW1wdHlYID0gdGhpcy5zaXplIC0gMTtcclxuICAgIHRoaXMuZW1wdHlZID0gdGhpcy5zaXplIC0gMTtcclxuXHJcbiAgICB0aGlzLmFyciA9IHRoaXMuY3JlYXRlQm9hcmQoKTtcclxuICAgIHRoaXMud2luID0gdGhpcy5jcmVhdGVCb2FyZCgpO1xyXG5cclxuICAgIHRoaXMuc2h1ZmZsZSgpO1xyXG5cclxuICAgIHRoaXMucmVuZGVyQm9hcmQoKTtcclxuICAgIHRoaXMudGltZXJDLmluaXQoKTtcclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpLmZvckVhY2goKGNlbGwpID0+IHtcclxuICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGV2dCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVsZW0gPSBldnQudGFyZ2V0O1xyXG4gICAgICAgIHRoaXMuc3dhcChwYXJzZUludChlbGVtLmlubmVySFRNTCwgMTApKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0KTtcclxuXHJcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVyKTtcclxuXHJcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJhZ0Ryb3ApO1xyXG5cclxuICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbG9hZCgpIHtcclxuICAgIHRoaXMuY2VsbFNpemUgPSBwYXJzZUZsb2F0KHRoaXMuYm9hcmRXaWR0aCAvIHRoaXMuc2l6ZSAtIDIgKiB0aGlzLm1hcmdpblNpemUpLnRvRml4ZWQoMyk7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW92ZScpLmlubmVySFRNTCA9IHRoaXMubW92ZXNDb3VudGVyO1xyXG4gICAgdGhpcy5yZW1vdmVCb2FyZCgpO1xyXG4gICAgdGhpcy5yZW5kZXJCb2FyZCgpO1xyXG4gICAgdGhpcy53aW4gPSB0aGlzLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICB0aGlzLnRpbWVyQy5pbml0KCk7XHJcblxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKS5mb3JFYWNoKChjZWxsKSA9PiB7XHJcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChldnQpID0+IHtcclxuICAgICAgICBjb25zdCBlbGVtID0gZXZ0LnRhcmdldDtcclxuICAgICAgICB0aGlzLnN3YXAocGFyc2VJbnQoZWxlbS5pbm5lckhUTUwsIDEwKSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydCk7XHJcblxyXG4gICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3Zlcik7XHJcblxyXG4gICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyYWdEcm9wKTtcclxuXHJcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==