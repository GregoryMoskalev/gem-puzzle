(()=>{"use strict";const t=new class{constructor(){this.history=[],this.size=4,this.emptyX=0,this.emptyY=0,this.arr=[],this.movesCounter=null,this.removeBoard=()=>{document.querySelectorAll(".board").forEach((t=>{document.body.removeChild(t)}))}}move(t){switch(t){case"up":this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX-1][this.emptyY],this.arr[this.emptyX-1][this.emptyY]=0,this.emptyX-=1;break;case"down":this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX+1][this.emptyY],this.arr[this.emptyX+1][this.emptyY]=0,this.emptyX+=1;break;case"right":this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX][this.emptyY+1],this.arr[this.emptyX][this.emptyY+1]=0,this.emptyY+=1;break;case"left":this.arr[this.emptyX][this.emptyY]=this.arr[this.emptyX][this.emptyY-1],this.arr[this.emptyX][this.emptyY-1]=0,this.emptyY-=1;break;default:throw new Error(">:(")}}shuffle(){this.history.push([this.emptyX,this.emptyY]);for(let t=0;t<80;t+=1)switch(Math.floor(4*Math.random())){case 0:0!==this.emptyX?this.move("up"):this.move("down"),this.history.push([this.emptyX,this.emptyY]);break;case 1:this.emptyY!==this.size-1?this.move("right"):this.move("left"),this.history.push([this.emptyX,this.emptyY]);break;case 2:this.emptyX!==this.size-1?this.move("down"):this.move("up"),this.history.push([this.emptyX,this.emptyY]);break;case 3:0!==this.emptyY?this.move("left"):(this.move("right"),this.history.push([this.emptyX,this.emptyY]));break;default:throw t-=1,new Error(">:(")}}renderBoard(){this.movesCounter=0,document.querySelector(".move").innerHTML=this.movesCounter;let t,e="";for(let s=0,i=1;s<this.size;s+=1)for(let r=0;r<this.size;r+=1){t=this.arr[s][r];const h=this.arr[s][r]?"cell":"empty";i+=1,e+=`<div style='order:${i};' id='cell-${t}' class='${h}'>${t}</div>`}const s=document.createElement("div");s.classList.add("board"),s.innerHTML=e,document.body.appendChild(s)}createBoard(){this.emptyX=this.size-1,this.emptyY=this.size-1;for(let t=0;t<this.size;t+=1){this.arr[t]=[];for(let e=0;e<this.size;e+=1)t+e!==2*(this.size-1)?this.arr[t][e]=t*this.size+e+1:this.arr[t][e]=0}}swap(t){for(let e=0;e<this.arr.length;e+=1)for(let s=0;s<this.arr[e].length;s+=1)if(this.arr[e][s]===t&&(Math.abs(this.emptyX-e)<=1&&this.emptyY-s==0||Math.abs(this.emptyY-s)<=1&&this.emptyX-e==0)){this.movesCounter+=1,document.querySelector(".move").innerHTML=this.movesCounter;const t=document.querySelector("#cell-"+this.arr[this.emptyX][this.emptyY]),i=document.querySelector("#cell-"+this.arr[e][s]),r=t.style.order;return t.style.order=i.style.order,i.style.order=r,[this.arr[e][s],this.arr[this.emptyX][this.emptyY]]=[this.arr[this.emptyX][this.emptyY],this.arr[e][s]],this.emptyX=e,this.emptyY=s,void console.table(this.arr)}}init(){this.removeBoard(),this.createBoard(),this.shuffle(),this.renderBoard(),console.table(this.arr),document.querySelectorAll(".cell").forEach((t=>{t.addEventListener("mousedown",(t=>{const e=t.target;this.swap(parseInt(e.innerHTML,10))}))}))}},e=document.createElement("header");e.innerHTML='  \n<header class="header">\n  <button class="new-game">New game</button>\n  <div class="timer"><span>Timer:</span><span class="time">0</span></div>\n  <div class="moves"><span>Moves:</span><span class="move">0</span></div>\n</header>',document.body.appendChild(e),t.init(),document.querySelector(".new-game").addEventListener("click",(()=>{t.init()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW0tcHV6emxlLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2dlbS1wdXp6bGUvLi9zcmMvYm9hcmQuanMiXSwibmFtZXMiOlsiYm9hcmQiLCJ0aGlzIiwiaGlzdG9yeSIsInNpemUiLCJlbXB0eVgiLCJlbXB0eVkiLCJhcnIiLCJtb3Zlc0NvdW50ZXIiLCJyZW1vdmVCb2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbGVtIiwiYm9keSIsInJlbW92ZUNoaWxkIiwiZGlyZWN0aW9uIiwiRXJyb3IiLCJwdXNoIiwiaSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm1vdmUiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiY2VsbE51bWJlciIsIm9yZGVyIiwiaiIsImNsYXNzTmFtZSIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJudW1iZXIiLCJsZW5ndGgiLCJhYnMiLCJ6ZXJvIiwiZSIsInRlbXAiLCJzdHlsZSIsImNvbnNvbGUiLCJ0YWJsZSIsImNyZWF0ZUJvYXJkIiwic2h1ZmZsZSIsInJlbmRlckJvYXJkIiwiY2VsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJ0YXJnZXQiLCJzd2FwIiwicGFyc2VJbnQiLCJoZWFkZXIiLCJpbml0Il0sIm1hcHBpbmdzIjoibUJBR0EsTUFBTUEsRUFBUSxJQ0hDLE1BQ2IsY0FDRUMsS0FBS0MsUUFBVSxHQUNmRCxLQUFLRSxLQUFPLEVBQ1pGLEtBQUtHLE9BQVMsRUFDZEgsS0FBS0ksT0FBUyxFQUNkSixLQUFLSyxJQUFNLEdBQ1hMLEtBQUtNLGFBQWUsS0FFcEJOLEtBQUtPLFlBQWMsS0FDakJDLFNBQVNDLGlCQUFpQixVQUFVQyxTQUFTQyxJQUMzQ0gsU0FBU0ksS0FBS0MsWUFBWUYsT0FPaEMsS0FBS0csR0FDSCxPQUFRQSxHQUNOLElBQUssS0FDSGQsS0FBS0ssSUFBSUwsS0FB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LFNBQVksQ0FDdkRKLEtBQUtLLElBQUlMLEtBQUtHLFFBQVFILEtBQUtJLFFBQzNCSixLQUFLSyxJQUFJWSxHQUFHUyxJQUVkMUIsS0FBS0csT0FBU2MsRUFDZGpCLEtBQUtJLE9BQVNzQixPQUNkYyxRQUFRQyxNQUFNekMsS0FBS0ssTUFRN0IsT0FDRUwsS0FBS08sY0FDTFAsS0FBSzBDLGNBQ0wxQyxLQUFLMkMsVUFDTDNDLEtBQUs0QyxjQUVMSixRQUFRQyxNQUFNekMsS0FBS0ssS0FFbkJHLFNBQVNDLGlCQUFpQixTQUFTQyxTQUFTbUMsSUFDMUNBLEVBQUtDLGlCQUFpQixhQUFjQyxJQUNsQyxNQUFNcEMsRUFBT29DLEVBQUlDLE9BQ2pCaEQsS0FBS2lELEtBQUtDLFNBQVN2QyxFQUFLWSxVQUFXLGFEbExyQzRCLEVBQVMzQyxTQUFTcUIsY0FBYyxVQUV0Q3NCLEVBQU81QixVQUFZLDZPQU9uQmYsU0FBU0ksS0FBS29CLFlBQVltQixHQUUxQnBELEVBQU1xRCxPQUVONUMsU0FBU2MsY0FBYyxhQUFhd0IsaUJBQWlCLFNBQVMsS0FFNUQvQyxFQUFNcUQsVyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJvYXJkIGZyb20gJy4vYm9hcmQuanMnO1xyXG4vLyBpbXBvcnQgVGltZXIgZnJvbSAnLi90aW1lci5qcyc7XHJcblxyXG5jb25zdCBib2FyZCA9IG5ldyBCb2FyZCgpO1xyXG5cclxuY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XHJcblxyXG5oZWFkZXIuaW5uZXJIVE1MID0gYCAgXHJcbjxoZWFkZXIgY2xhc3M9XCJoZWFkZXJcIj5cclxuICA8YnV0dG9uIGNsYXNzPVwibmV3LWdhbWVcIj5OZXcgZ2FtZTwvYnV0dG9uPlxyXG4gIDxkaXYgY2xhc3M9XCJ0aW1lclwiPjxzcGFuPlRpbWVyOjwvc3Bhbj48c3BhbiBjbGFzcz1cInRpbWVcIj4wPC9zcGFuPjwvZGl2PlxyXG4gIDxkaXYgY2xhc3M9XCJtb3Zlc1wiPjxzcGFuPk1vdmVzOjwvc3Bhbj48c3BhbiBjbGFzcz1cIm1vdmVcIj4wPC9zcGFuPjwvZGl2PlxyXG48L2hlYWRlcj5gO1xyXG5cclxuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChoZWFkZXIpO1xyXG5cclxuYm9hcmQuaW5pdCgpO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy1nYW1lJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblxyXG4gIGJvYXJkLmluaXQoKTtcclxufSk7XHJcblxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm9hcmQge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5oaXN0b3J5ID0gW107XHJcbiAgICB0aGlzLnNpemUgPSA0O1xyXG4gICAgdGhpcy5lbXB0eVggPSAwO1xyXG4gICAgdGhpcy5lbXB0eVkgPSAwO1xyXG4gICAgdGhpcy5hcnIgPSBbXTtcclxuICAgIHRoaXMubW92ZXNDb3VudGVyID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLnJlbW92ZUJvYXJkID0gKCkgPT4ge1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYm9hcmQnKS5mb3JFYWNoKChlbGVtKSA9PiB7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gbGV0IHNpemUgPSA0O1xyXG5cclxuICBtb3ZlKGRpcmVjdGlvbikge1xyXG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcclxuICAgICAgY2FzZSAndXAnOlxyXG4gICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WV0gPSB0aGlzLmFyclt0aGlzLmVtcHR5WCAtIDFdW3RoaXMuZW1wdHlZXTtcclxuICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WCAtIDFdW3RoaXMuZW1wdHlZXSA9IDA7XHJcbiAgICAgICAgdGhpcy5lbXB0eVggLT0gMTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZG93bic6XHJcbiAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZXSA9IHRoaXMuYXJyW3RoaXMuZW1wdHlYICsgMV1bdGhpcy5lbXB0eVldO1xyXG4gICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYICsgMV1bdGhpcy5lbXB0eVldID0gMDtcclxuICAgICAgICB0aGlzLmVtcHR5WCArPSAxO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZXSA9IHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WSArIDFdO1xyXG4gICAgICAgIHRoaXMuYXJyW3RoaXMuZW1wdHlYXVt0aGlzLmVtcHR5WSArIDFdID0gMDtcclxuICAgICAgICB0aGlzLmVtcHR5WSArPSAxO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldID0gdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZIC0gMV07XHJcbiAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZIC0gMV0gPSAwO1xyXG4gICAgICAgIHRoaXMuZW1wdHlZIC09IDE7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCc+OignKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNodWZmbGUoKSB7XHJcbiAgICAvLyB0aGlzLmVtcHR5WCA9IHNpemUgLSAxO1xyXG4gICAgLy8gdGhpcy5lbXB0eVkgPSBzaXplIC0gMTtcclxuICAgIHRoaXMuaGlzdG9yeS5wdXNoKFsgdGhpcy5lbXB0eVgsIHRoaXMuZW1wdHlZIF0pO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODA7IGkgKz0gMSkge1xyXG4gICAgICBzd2l0Y2ggKE1hdGguZmxvb3IoNCAqIE1hdGgucmFuZG9tKCkpKSB7XHJcbiAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgaWYgKHRoaXMuZW1wdHlYICE9PSAwKSB7XHJcbiAgICAgICAgICAgIC8vICBNT1ZFIFVQXHJcblxyXG4gICAgICAgICAgICB0aGlzLm1vdmUoJ3VwJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgTU9WRSBET1dOXHJcbiAgICAgICAgICAgIHRoaXMubW92ZSgnZG93bicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5oaXN0b3J5LnB1c2goWyB0aGlzLmVtcHR5WCwgdGhpcy5lbXB0eVkgXSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICBpZiAodGhpcy5lbXB0eVkgIT09IHRoaXMuc2l6ZSAtIDEpIHtcclxuICAgICAgICAgICAgLy8gIE1PVkUgUklHSFRcclxuICAgICAgICAgICAgdGhpcy5tb3ZlKCdyaWdodCcpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gIE1PVkUgTEVGVFxyXG4gICAgICAgICAgICB0aGlzLm1vdmUoJ2xlZnQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuaGlzdG9yeS5wdXNoKFsgdGhpcy5lbXB0eVgsIHRoaXMuZW1wdHlZIF0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgaWYgKHRoaXMuZW1wdHlYICE9PSB0aGlzLnNpemUgLSAxKSB7XHJcbiAgICAgICAgICAgIC8vICBNT1ZFIERPV05cclxuICAgICAgICAgICAgdGhpcy5tb3ZlKCdkb3duJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgTU9WRSBVUFxyXG4gICAgICAgICAgICB0aGlzLm1vdmUoJ3VwJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaChbIHRoaXMuZW1wdHlYLCB0aGlzLmVtcHR5WSBdKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgIGlmICh0aGlzLmVtcHR5WSAhPT0gMCkge1xyXG4gICAgICAgICAgICAvLyAgTU9WRSBMRUZUXHJcbiAgICAgICAgICAgIHRoaXMubW92ZSgnbGVmdCcpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gIE1PVkUgUklHSFRcclxuICAgICAgICAgICAgdGhpcy5tb3ZlKCdyaWdodCcpO1xyXG4gICAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaChbIHRoaXMuZW1wdHlYLCB0aGlzLmVtcHR5WSBdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBpIC09IDE7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJz46KCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXJCb2FyZCgpIHtcclxuICAgIHRoaXMubW92ZXNDb3VudGVyID0gMDtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb3ZlJykuaW5uZXJIVE1MID0gdGhpcy5tb3Zlc0NvdW50ZXI7XHJcblxyXG4gICAgbGV0IGJvYXJkID0gJyc7XHJcbiAgICBsZXQgY2VsbE51bWJlcjtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMCwgb3JkZXIgPSAxOyBpIDwgdGhpcy5zaXplOyBpICs9IDEpIHtcclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnNpemU7IGogKz0gMSkge1xyXG4gICAgICAgIGNlbGxOdW1iZXIgPSB0aGlzLmFycltpXVtqXTtcclxuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLmFycltpXVtqXSA/ICdjZWxsJyA6ICdlbXB0eSc7XHJcbiAgICAgICAgb3JkZXIgKz0gMTtcclxuICAgICAgICBib2FyZCArPSBgPGRpdiBzdHlsZT0nb3JkZXI6JHtvcmRlcn07JyBpZD0nY2VsbC0ke2NlbGxOdW1iZXJ9JyBjbGFzcz0nJHtjbGFzc05hbWV9Jz4ke2NlbGxOdW1iZXJ9PC9kaXY+YDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYm9hcmQnKTtcclxuXHJcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IGJvYXJkO1xyXG5cclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVCb2FyZCgpIHtcclxuICAgIHRoaXMuZW1wdHlYID0gdGhpcy5zaXplIC0gMTtcclxuICAgIHRoaXMuZW1wdHlZID0gdGhpcy5zaXplIC0gMTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zaXplOyBpICs9IDEpIHtcclxuICAgICAgdGhpcy5hcnJbaV0gPSBbXTtcclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnNpemU7IGogKz0gMSkge1xyXG4gICAgICAgIGlmIChpICsgaiAhPT0gKHRoaXMuc2l6ZSAtIDEpICogMikge1xyXG4gICAgICAgICAgdGhpcy5hcnJbaV1bal0gPSBpICogdGhpcy5zaXplICsgaiArIDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuYXJyW2ldW2pdID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN3YXAobnVtYmVyKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYXJyLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5hcnJbaV0ubGVuZ3RoOyBqICs9IDEpIHtcclxuICAgICAgICBpZiAodGhpcy5hcnJbaV1bal0gPT09IG51bWJlcikge1xyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAoTWF0aC5hYnModGhpcy5lbXB0eVggLSBpKSA8PSAxICYmIHRoaXMuZW1wdHlZIC0gaiA9PT0gMCkgfHxcclxuICAgICAgICAgICAgKE1hdGguYWJzKHRoaXMuZW1wdHlZIC0gaikgPD0gMSAmJiB0aGlzLmVtcHR5WCAtIGkgPT09IDApXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgLy8gTW92ZSBjb3VudGVyXHJcbiAgICAgICAgICAgIHRoaXMubW92ZXNDb3VudGVyICs9IDE7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb3ZlJykuaW5uZXJIVE1MID0gdGhpcy5tb3Zlc0NvdW50ZXI7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB6ZXJvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NlbGwtJHt0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldfWApO1xyXG4gICAgICAgICAgICBjb25zdCBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NlbGwtJHt0aGlzLmFycltpXVtqXX1gKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSB6ZXJvLnN0eWxlLm9yZGVyO1xyXG4gICAgICAgICAgICB6ZXJvLnN0eWxlLm9yZGVyID0gZS5zdHlsZS5vcmRlcjtcclxuICAgICAgICAgICAgZS5zdHlsZS5vcmRlciA9IHRlbXA7XHJcblxyXG4gICAgICAgICAgICBbIHRoaXMuYXJyW2ldW2pdLCB0aGlzLmFyclt0aGlzLmVtcHR5WF1bdGhpcy5lbXB0eVldIF0gPSBbXHJcbiAgICAgICAgICAgICAgdGhpcy5hcnJbdGhpcy5lbXB0eVhdW3RoaXMuZW1wdHlZXSxcclxuICAgICAgICAgICAgICB0aGlzLmFycltpXVtqXVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB0aGlzLmVtcHR5WCA9IGk7XHJcbiAgICAgICAgICAgIHRoaXMuZW1wdHlZID0gajtcclxuICAgICAgICAgICAgY29uc29sZS50YWJsZSh0aGlzLmFycik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICB0aGlzLnJlbW92ZUJvYXJkKCk7XHJcbiAgICB0aGlzLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICB0aGlzLnNodWZmbGUoKTtcclxuICAgIHRoaXMucmVuZGVyQm9hcmQoKTtcclxuXHJcbiAgICBjb25zb2xlLnRhYmxlKHRoaXMuYXJyKTtcclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpLmZvckVhY2goKGNlbGwpID0+IHtcclxuICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWxlbSA9IGV2dC50YXJnZXQ7XHJcbiAgICAgICAgdGhpcy5zd2FwKHBhcnNlSW50KGVsZW0uaW5uZXJIVE1MLCAxMCkpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9